(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{574:function(e,t,r){"use strict";r.r(t);r(6),r(3),r(9),r(33);var n=r(8),o={layout:"guest",data:function(){return{azureForm:{},isRequested:!1,isApproved:!1,isLoading:!0}},created:function(){this.initialize()},computed:{account:function(){return this.$AuthService.getAccount()}},methods:{initialize:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$auth.user){t.next=4;break}e.$router.push("/"),t.next=12;break;case 4:return r=e.account,n=r?r.userName:null,o=r?r.idToken.aud:null,e.azureForm=Object.assign({},{email:n,aud:o}),t.next=10,e.$axios.post(e.$baseurl("login/azure/check"),e.azureForm);case 10:200===(c=t.sent).status?(e.isLoading=!1,0===Object.keys(c.data).length?e.isRequested=!1:(e.isRequested=!0,c.data.is_approved?(e.isApproved=!0,e.backendLogin(e.azureForm)):e.isApproved=!1)):e.$router.push("/login");case 12:case"end":return t.stop()}}),t)})))()},requestAccess:function(){return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"http://localhost:91/api/login/azure",window.open("http://localhost:91/api/login/azure"),window.close();case 3:case"end":return e.stop()}}),e)})))()},logout:function(){return this.$AuthService.logout()},backendLogin:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.$store.commit("SET_LOADING",!0),r.prev=1,r.next=4,t.$auth.loginWith("password_grant",{data:{username:e.email,password:null,isAzureLogin:!0}});case 4:t.$snackbar({icon:"mdi-checkbox-marked-circle.green",text:"You are logged in"}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(1),t.$snackbar({icon:"mdi-close-circle.red",text:"Invalid credentials"});case 10:case"end":return r.stop()}}),r,null,[[1,7]])})))()}}},c=r(32),l=r(30),d=r.n(l),v=r(447),m=r(177),h=r(40),f=r(462),x=r(151),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[e.isLoading?r("div",{staticClass:"text-h5 text-center"},[e._v("Loading...")]):r("div",[e.isApproved?r("div",{staticClass:"text-h5 text-center"},[e._v("Logging in. Please wait...")]):r("div",[r("v-card",{attrs:{outlined:""}},[r("v-card-title",[e.isRequested?r("span",[e._v("You already requested an access. Please wait for admin to approve")]):r("span",[e._v("Your account doesn't have access to this app")])]),e._v(" "),r("v-card-text",[r("v-text-field",{attrs:{label:"E-mail",type:"text",disabled:""},model:{value:e.azureForm.email,callback:function(t){e.$set(e.azureForm,"email",t)},expression:"azureForm.email"}})],1),e._v(" "),r("v-card-actions",[r("div",{staticClass:"d-flex flex-column",staticStyle:{width:"100%"}},[r("div",[r("v-btn",{attrs:{color:"primary",disabled:e.isRequested},on:{click:e.requestAccess}},[e._v("Request Access")]),e._v(" "),r("v-btn",{attrs:{color:"error",outlined:""},on:{click:e.logout}},[e._v("Signout Microsoft")])],1),e._v(" "),r("a",{staticClass:"text-caption mt-2",attrs:{href:"javascript:location.reload();"}},[e._v("Admin approved your request? Click here to refresh this page.")])])])],1)],1)])])}),[],!1,null,null,null);t.default=component.exports;d()(component,{VBtn:v.a,VCard:m.a,VCardActions:h.a,VCardText:h.b,VCardTitle:h.c,VContainer:f.a,VTextField:x.a})}}]);